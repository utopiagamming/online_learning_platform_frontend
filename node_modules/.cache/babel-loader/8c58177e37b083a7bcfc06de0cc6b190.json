{"remainingRequest":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\babel-loader\\lib\\index.js!D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\working\\projectCodes\\automatic-test-paper\\src\\components\\page\\system\\RoleInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\working\\projectCodes\\automatic-test-paper\\src\\components\\page\\system\\RoleInfo.vue","mtime":1633955552000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["export default {\n  name: \"RoleInfo\",\n  //局部刷新控制\n  inject: ['reload'],\n  data() {\n    return {\n      defaultProps: {\n        children: 'children',\n        label: 'label'\n      },\n      addRoleShow: false,\n      menuShow: false,\n      menu: '',\n      data: [],\n      checkData: [],\n      tableData: [],\n      currentNum: 1,\n      pageSize: 10,\n      startDate: '',\n      total: 0,\n      endDate: '',\n      tableDataShow: false,\n      roleId: '',\n      form: {\n        roleId: '',\n        roleName: ''\n      }\n    };\n  },\n  methods: {\n    handleClose(done) {\n      this.$confirm('确认关闭？').then(_ => {\n        done();\n      }).catch(_ => {});\n    },\n    setBeginTime(date) {\n      //设置时间\n      this.stratDate = date;\n    },\n    setEndTime(date) {\n      //设置时间\n      this.endDate = date;\n    },\n    changePage(page) {\n      //设置页码\n      this.currentNum = page;\n      this.queryRoleBaseQuery();\n    },\n    changePageSize(pageSize) {\n      //设置每页展示数量\n      this.pageSize = pageSize;\n      this.queryRoleBaseQuery();\n    },\n    ok() {\n      let checkedKeys = this.$refs.tree.getCheckedKeys();\n      let halfCheckedKeys = this.$refs.tree.getHalfCheckedKeys();\n      console.log(halfCheckedKeys);\n      halfCheckedKeys.forEach(f => {\n        checkedKeys.push(f);\n      });\n      let params = {\n        roleId: this.roleId,\n        menuIdString: JSON.stringify(checkedKeys)\n      };\n      this.axios.post('/zj/menu/updateRoleMenuInfo.htm', params).then(function (response) {\n        if (response.data.code == \"0000\") {\n          this.$message.success(\"修改成功\");\n        } else {\n          this.$message.error(\"修改失败\");\n        }\n      }.bind(this)).catch(function (error) {\n        console.log(error);\n      });\n    },\n    getCheckedKeys() {\n      console.log(this.$refs.tree.getCheckedKeys());\n    },\n    cancel() {\n      this.$Message.info('保存取消');\n    },\n    queryRoleBaseQuery() {\n      let params = {\n        currentNum: this.currentNum,\n        pageSize: this.pageSize,\n        keyWords: this.search\n      };\n      this.axios.post('/zj/role/rolePage.htm', params).then(function (response) {\n        this.tableData = response.data.result.list;\n        this.total = response.data.result.count;\n        this.tableDataShow = true;\n      }.bind(this)).catch(function (error) {\n        console.log(error);\n      });\n    },\n    insertRoleInfo() {\n      let param = {\n        roleId: this.form.roleId,\n        roleName: this.form.roleName\n      };\n      this.axios.post('/zj/role/insertRoleInfo.htm', param).then(function (response) {\n        if (response.data.code == \"0000\") {\n          this.$message.success(\"新增成功\");\n          this.addRoleShow = false;\n          this.reload();\n        } else {\n          this.$message.error(\"新增失败\");\n        }\n      }.bind(this)).catch(function (error) {\n        console.log(error);\n      });\n    },\n    deleteRole(sid) {\n      console.log(sid);\n      let param = {\n        id: sid\n      };\n      this.axios.post('/zj/role/deleteRole.htm', param).then(function (response) {\n        if (response.data.code == \"0000\") {\n          this.$message.success(\"删除成功\");\n          this.reload();\n        } else {\n          this.$message.error(\"删除失败\");\n        }\n      }.bind(this)).catch(function (error) {\n        console.log(error);\n      });\n    },\n    queryRoleMenu(roleId) {\n      this.roleId = roleId;\n      let params = {\n        roleId: roleId\n      };\n      this.axios.post('/zj/menu/queryMenuListByRoleId.htm', params).then(function (response) {\n        this.menuShow = true;\n        this.data = response.data.result;\n      }.bind(this)).catch(function (error) {\n        console.log(error);\n      });\n      this.axios.post('/zj/menu/queryMenuIdListByRoleId.htm', params).then(function (response) {\n        this.checkData = response.data.result;\n      }.bind(this)).catch(function (error) {\n        console.log(error);\n      });\n    }\n  },\n  created() {\n    this.queryRoleBaseQuery();\n  }\n};",{"version":3,"mappings":"AA6FA;EACAA;EACA;EACAC;EACAC;IACA;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAN;MACAO;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAD;QACAE;MACA;IACA;EAEA;EACAC;IACAC;MACA,uBACAC;QACAC;MACA,GACAC,YACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACAC;MACAC;QACAC;MACA;MACA;QACAf;QACAgB;MACA;MACA,WACAC,gDACAZ,KACA;QACA;UACA;QACA;UACA;QACA;MACA,aACA,CACAE;QACAM;MACA;IACA;IACAK;MACAL;IACA;IACAM;MACA;IACA;IACAC;MACA;QACA1B;QACAC;QACA0B;MACA;MACA,WACAJ,sCACAZ,KACA;QACA;QACA;QACA;MACA,aACA,CACAE;QACAM;MACA;IACA;IACAS;MACA;QACAtB;QACAE;MACA;MACA,WACAe,2CACAZ,KACA;QACA;UACA;UACA;UACA;QACA;UACA;QACA;MACA,aACA,CACAE;QACAM;MACA;IACA;IACAU;MACAV;MACA;QACAW;MACA;MACA,WACAP,uCACAZ,KACA;QACA;UACA;UACA;QACA;UACA;QACA;MACA,aACA,CACAE;QACAM;MACA;IACA;IACAY;MACA;MACA;QACAzB;MACA;MACA,WACAiB,mDACAZ,KACA;QACA;QACA;MAEA,aACA,CACAE;QACAM;MACA;MAEA,WACAI,qDACAZ,KACA;QACA;MACA,aACA,CACAE;QACAM;MACA;IAGA;EACA;EAEAa;IACA;EACA;AACA","names":["name","inject","data","defaultProps","children","label","addRoleShow","menuShow","menu","checkData","tableData","currentNum","pageSize","startDate","total","endDate","tableDataShow","roleId","form","roleName","methods","handleClose","then","done","catch","setBeginTime","setEndTime","changePage","changePageSize","ok","console","halfCheckedKeys","checkedKeys","menuIdString","post","getCheckedKeys","cancel","queryRoleBaseQuery","keyWords","insertRoleInfo","deleteRole","id","queryRoleMenu","created"],"sourceRoot":"src/components/page/system","sources":["RoleInfo.vue"],"sourcesContent":["<template>\n    <div>\n        <div class=\"crumbs\">\n            <el-breadcrumb separator=\"/\">\n                <el-breadcrumb-item>\n                    <i class=\"el-icon-lx-calendar\"></i> 系统管理\n                </el-breadcrumb-item>\n                <el-breadcrumb-item>角色管理</el-breadcrumb-item>\n            </el-breadcrumb>\n        </div>\n\n        <el-button type=\"primary\" @click=\"addRoleShow=true\" style=\"margin-left: 90%\">角色新增</el-button>\n\n        <div>\n            <el-table\n                    :data=\"tableData\"\n                    height=\"550\"\n                    border\n                    style=\"width: 100%\">\n                <el-table-column\n                        type=\"index\"\n                        width=\"50\">\n                </el-table-column>\n                <el-table-column\n                        prop=\"roleId\"\n                        label=\"角色Id\"\n                >\n                </el-table-column>\n                <el-table-column\n                        prop=\"roleName\"\n                        label=\"角色名称\"\n                >\n                </el-table-column>\n\n                <el-table-column prop=\"type\" label=\"操作\" style=\"padding-left: 100%\">\n                    <template slot-scope=\"scope\">\n                        <el-button type=\"primary\" @click=\"queryRoleMenu(scope.row.roleId)\">角色菜单配置</el-button>\n                        <el-button type=\"danger\" @click=\"deleteRole(scope.row.id)\">角色删除</el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n            <Page :total=\"total\"\n                  show-total\n                  show-sizer\n                  :page-size-opts=\"[10, 20, 30, 40, 10000]\"\n                  v-show=\"tableDataShow\"\n                  @on-change=\"changePage\"\n                  @on-page-size-change=\"changePageSize\"\n                  style=\"text-align: center;\"\n            />\n        </div>\n        <el-dialog\n                title=\"角色新增\"\n                :visible.sync=\"addRoleShow\"\n                width=\"20%\"\n                :before-close=\"handleClose\">\n            <span>\n                <el-form ref=\"form\" :model=\"form\">\n                    <el-form-item label=\"角色ID\" label-width=\"100px\">\n                        <el-input v-model=\"form.roleId\" style=\"width: 180px\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"角色名称\" label-width=\"100px\">\n                        <el-input v-model=\"form.roleName\" style=\"width: 180px\"></el-input>\n                    </el-form-item>\n                </el-form>\n            </span>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"addRoleShow = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"insertRoleInfo\">确 定</el-button>\n            </span>\n        </el-dialog>\n\n        <!--        <el-button type=\"text\" @click=\"addRoleShow\">点击打开 Message Box</el-button>-->\n\n\n        <Modal v-model=\"menuShow\" title=\"角色菜单\" @on-ok=\"ok\" @on-cancel=\"cancel\" style=\"width: 400px\">\n            <div style=\"max-height: 50rem\">\n                <el-tree\n                        :data=\"data\"\n                        show-checkbox\n                        node-key=\"id\"\n                        highlight-current\n                        ref=\"tree\"\n                        :props=\"defaultProps\"\n                        :default-checked-keys=\"checkData\">\n                </el-tree>\n            </div>\n        </Modal>\n    </div>\n\n</template>\n\n<script>\n    export default {\n        name: \"RoleInfo\",\n        //局部刷新控制\n        inject:['reload'],\n        data() {\n            return {\n                defaultProps: {\n                    children: 'children',\n                    label: 'label'\n                },\n                addRoleShow: false,\n                menuShow: false,\n                menu: '',\n                data: [],\n                checkData: [],\n                tableData: [],\n                currentNum: 1,\n                pageSize: 10,\n                startDate: '',\n                total: 0,\n                endDate: '',\n                tableDataShow: false,\n                roleId: '',\n                form: {\n                    roleId: '',\n                    roleName: ''\n                },\n            }\n\n        },\n        methods: {\n            handleClose(done) {\n                this.$confirm('确认关闭？')\n                    .then(_ => {\n                        done();\n                    })\n                    .catch(_ => {\n                    });\n            },\n            setBeginTime(date) {\n                //设置时间\n                this.stratDate = date;\n            },\n            setEndTime(date) {\n                //设置时间\n                this.endDate = date;\n            },\n            changePage(page) {\n                //设置页码\n                this.currentNum = page;\n                this.queryRoleBaseQuery();\n            },\n            changePageSize(pageSize) {\n                //设置每页展示数量\n                this.pageSize = pageSize;\n                this.queryRoleBaseQuery();\n            },\n            ok() {\n                let checkedKeys = this.$refs.tree.getCheckedKeys();\n                let halfCheckedKeys = this.$refs.tree.getHalfCheckedKeys();\n                console.log(halfCheckedKeys)\n                halfCheckedKeys.forEach(f=>{\n                    checkedKeys.push(f)\n                })\n                let params = {\n                    roleId: this.roleId,\n                    menuIdString: JSON.stringify(checkedKeys)\n                };\n                this.axios\n                    .post('/zj/menu/updateRoleMenuInfo.htm', params)\n                    .then(\n                        function (response) {\n                            if (response.data.code == \"0000\") {\n                                this.$message.success(\"修改成功\");\n                            } else {\n                                this.$message.error(\"修改失败\");\n                            }\n                        }.bind(this)\n                    )\n                    .catch(function (error) {\n                        console.log(error);\n                    });\n            },\n            getCheckedKeys() {\n                console.log(this.$refs.tree.getCheckedKeys());\n            },\n            cancel() {\n                this.$Message.info('保存取消');\n            },\n            queryRoleBaseQuery() {\n                let params = {\n                    currentNum: this.currentNum,\n                    pageSize: this.pageSize,\n                    keyWords: this.search,\n                };\n                this.axios\n                    .post('/zj/role/rolePage.htm', params)\n                    .then(\n                        function (response) {\n                            this.tableData = response.data.result.list;\n                            this.total = response.data.result.count;\n                            this.tableDataShow = true;\n                        }.bind(this)\n                    )\n                    .catch(function (error) {\n                        console.log(error);\n                    });\n            },\n            insertRoleInfo() {\n                let param = {\n                    roleId: this.form.roleId,\n                    roleName: this.form.roleName\n                }\n                this.axios\n                    .post('/zj/role/insertRoleInfo.htm', param)\n                    .then(\n                        function (response) {\n                            if (response.data.code == \"0000\") {\n                                this.$message.success(\"新增成功\");\n                                this.addRoleShow = false\n                                this.reload();\n                            } else {\n                                this.$message.error(\"新增失败\");\n                            }\n                        }.bind(this)\n                    )\n                    .catch(function (error) {\n                        console.log(error);\n                    });\n            },\n            deleteRole(sid) {\n                console.log(sid)\n                let param = {\n                    id: sid,\n                }\n                this.axios\n                    .post('/zj/role/deleteRole.htm', param)\n                    .then(\n                        function (response) {\n                            if (response.data.code == \"0000\") {\n                                this.$message.success(\"删除成功\");\n                                this.reload();\n                            } else {\n                                this.$message.error(\"删除失败\");\n                            }\n                        }.bind(this)\n                    )\n                    .catch(function (error) {\n                        console.log(error);\n                    });\n            },\n            queryRoleMenu(roleId) {\n                this.roleId = roleId;\n                let params = {\n                    roleId: roleId,\n                };\n                this.axios\n                    .post('/zj/menu/queryMenuListByRoleId.htm', params)\n                    .then(\n                        function (response) {\n                            this.menuShow = true;\n                            this.data = response.data.result;\n\n                        }.bind(this)\n                    )\n                    .catch(function (error) {\n                        console.log(error);\n                    });\n\n                this.axios\n                    .post('/zj/menu/queryMenuIdListByRoleId.htm', params)\n                    .then(\n                        function (response) {\n                            this.checkData = response.data.result;\n                        }.bind(this)\n                    )\n                    .catch(function (error) {\n                        console.log(error);\n                    });\n\n\n            },\n        }\n        ,\n        created() {\n            this.queryRoleBaseQuery();\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n"]}]}