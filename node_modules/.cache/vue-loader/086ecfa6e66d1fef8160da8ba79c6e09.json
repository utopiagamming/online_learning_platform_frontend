{"remainingRequest":"/Users/mirabilite/IdeaProjects/version1/automatic-test-paper/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mirabilite/IdeaProjects/version1/automatic-test-paper/src/components/page/study/Upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mirabilite/IdeaProjects/version1/automatic-test-paper/src/components/page/study/Upload.vue","mtime":1684292539069},{"path":"/Users/mirabilite/IdeaProjects/version1/automatic-test-paper/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mirabilite/IdeaProjects/version1/automatic-test-paper/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/mirabilite/IdeaProjects/version1/automatic-test-paper/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mirabilite/IdeaProjects/version1/automatic-test-paper/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nexport default {\r\n  name: \"Upload\",\r\n  data() {\r\n    return {\r\n      videoName:'',\r\n      videoUrl:'',\r\n      videoDuration:0,\r\n      videoSize:0.0,\r\n      conceptId:0,\r\n      tableData: [],\r\n      currentNum: 1,\r\n      pageSize: 10,\r\n      total: 0,\r\n      dataShow:true,\r\n      tableDataShow: true,\r\n      // 修改删除\r\n      dialogUpdate:false,\r\n      video:{},\r\n      form:{\r\n        videoName:'',\r\n        videoUrl:'',\r\n        videoDuration:0,\r\n        videoSize:0.0,\r\n        conceptId:0,\r\n      },\r\n      // 新增\r\n      dialogInsert:false,\r\n      file:null,\r\n      videoData:null,\r\n      formData:null,\r\n    }\r\n  },\r\n  methods:{\r\n    queryPage(){\r\n      let params={\r\n        currentNum: this.currentNum,\r\n        pageSize: this.pageSize,\r\n      };\r\n      this.axios\r\n          .post('/zj/title/queryVideoList.htm',params)\r\n          .then(\r\n              function (response){\r\n                this.tableData=response.data.result.list;\r\n                console.log(this.tableData);\r\n                this.total = response.data.result.count;\r\n                this.tableDataShow=true;\r\n                this.dataShow=true;\r\n              }.bind(this)\r\n          )\r\n          .catch(function (error){\r\n            console.log(error);\r\n          });\r\n    },\r\n    updateVideo(){\r\n\r\n    },\r\n    deleteVideo(){\r\n\r\n    },\r\n    handleClose(done) {\r\n      this.$confirm('确认关闭？')\r\n          .then(_ => {\r\n            done();\r\n          })\r\n          .catch(_ => {\r\n          });\r\n    },\r\n    changePage(page) {\r\n      //设置页码\r\n      this.currentNum = page;\r\n      this.queryPage();\r\n    },\r\n    changePageSize(pageSize) {\r\n      //设置每页展示数量\r\n      this.pageSize = pageSize;\r\n      this.queryPage();\r\n    },\r\n    // 修改删除\r\n    updateClick(row){\r\n      this.dialogUpdate=true;\r\n    },\r\n    deleteCick(row){\r\n      let params={\r\n        videoId:row\r\n      };\r\n      this.axios\r\n          .post('/zj/title/deleteVideo.htm')\r\n          .then(\r\n              function (response) {\r\n                if (response.data.code == \"0000\") {\r\n                  this.$message.success(\"删除成功\");\r\n                  this.dialogVisible = false;\r\n                  this.reload();\r\n                } else {\r\n                  this.$message.error(\"删除失败\");\r\n                }\r\n              }.bind(this)\r\n          ).catch(function (erorr){\r\n            console.log(erorr);\r\n      });\r\n    },\r\n    // 上传视频\r\n    openFileBrowser() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    handleFileChange(event) {\r\n      const file = event.target.files[0];\r\n      // 处理选择的文件，例如上传到服务器等操作\r\n      let formData = new FormData();\r\n      formData.append(\"file\",file);\r\n      this.formData=formData;\r\n    },\r\n    uploadVideo(){\r\n      let params={\r\n        videoName:this.form.videoName,\r\n        videoUrl:this.form.videoUrl,\r\n        videoDuration:this.form.videoDuration,\r\n        videoSize:this.form.videoSize,\r\n        conceptId:this.form.conceptId,\r\n        videoData:this.formData,\r\n      };\r\n      // 将 params 和 formData 合并到一个 FormData 对象中\r\n      let formData = new FormData();\r\n      formData.append(\"file\", this.formData.get(\"file\")); // 从原来的 formData 中获取文件数据\r\n      Object.entries(params).forEach(([key, value]) => {\r\n        formData.append(key, value);\r\n      });\r\n      console.log(formData);\r\n      this.axios\r\n          .post('zj/title/uploadVideo.htm',formData, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data' // 设置请求头为 multipart/form-data\r\n            }}\r\n          )\r\n          .then(\r\n              function (response) {\r\n                if (response.data.code == \"0000\"){\r\n                  this.$message.success(\"上传成功\");\r\n                  this.dialogVisible  = false;\r\n                  this.reload();\r\n                }else {\r\n                  this.$message.error(\"该视频与库中已有视频重复，上传失败，请重新选择\");\r\n                }\r\n              }.bind(this)\r\n          )\r\n          .catch(function (error){\r\n            console.log(error);\r\n          })\r\n    },\r\n  },\r\n  created(){\r\n    this.queryPage();\r\n    console.log('created method called');\r\n  }\r\n}\r\n",{"version":3,"sources":["Upload.vue"],"names":[],"mappings":";AA0GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Upload.vue","sourceRoot":"src/components/page/study","sourcesContent":["<template>\r\n  <div>\r\n    <div>\r\n      <div class=\"crumbs\">\r\n        <el-breadcrumb separator=\"/\">\r\n          <el-breadcrumb-item>\r\n            <i class=\"el-icon-lx-calendar\"></i>学习管理\r\n          </el-breadcrumb-item>\r\n          <el-breadcrumb-item>视频管理</el-breadcrumb-item>\r\n        </el-breadcrumb>\r\n      </div>\r\n      <el-button style=\"\" type=\"primary\" @click=\"dialogInsert = true\" style=\"margin-left: 980px;margin-top: -150px;\">上传视频</el-button>\r\n    </div>\r\n\r\n    <el-table\r\n        :data=\"tableData\"\r\n        border\r\n        stripe\r\n        v-show=\"dataShow\"\r\n        style=\"width: 80%; margin-top: 10px;\">\r\n      <el-table-column type=\"index\" width=\"50\"  label=\"序号\"></el-table-column>\r\n      <el-table-column prop=\"videoName\" label=\"视频名称\" width=\"200\"></el-table-column>\r\n      <el-table-column prop=\"videoUrl\" label=\"视频地址\" width=\"100\"></el-table-column>\r\n      <el-table-column prop=\"videoDuration\" label=\"视频时长\" width=\"140\">\r\n        <template slot-scope=\"scope\">{{ Math.floor(scope.row.videoDuration/60)}}分{{ scope.row.videoDuration%60}}秒</template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"videoSize\" label=\"视频大小\" width=\"100\" >\r\n        <template slot-scope=\"scope\">{{ scope.row.videoSize}}M</template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"createTime\" label=\"上传时间\" width=\"160\"></el-table-column>\r\n      <el-table-column prop=\"updateTime\" label=\"修改时间\" width=\"160\"></el-table-column>\r\n      <el-table-column fixed=\"right\" label=\"操作\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button @click=\"updateClick(scope.row.videoId)\" type=\"text\" size=\"small\">编辑</el-button>\r\n          <el-button type=\"text\" size=\"small\" @click=\"deleteClick(scope.row.videoId)\" >删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <Page :total=\"total\"\r\n          show-total\r\n          show-sizer\r\n          :page-size-opts=\"[10, 20, 30, 40, 10000]\"\r\n          v-show=\"tableDataShow\"\r\n          @on-change=\"changePage\"\r\n          @on-page-size-change=\"changePageSize\"\r\n          style=\"margin-left: 400px; margin-top: 10px;\"\r\n    />\r\n\r\n    <el-dialog\r\n        title=\"提示\"\r\n        :visible.sync=\"dialogUpdate\"\r\n        width=\"30%\"\r\n        :before-close=\"handleClose\">\r\n      <el-form ref=\"form\" :model=\"video\">\r\n        <el-form-item label=\"视频名称\" prop=\"videoName\">\r\n          <el-input v-model=\"video.videoName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"视频时长\" prop=\"videoDuration\">\r\n          <el-input v-model=\"video.videoDuration\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"视频大小\" prop=\"videoSize\">\r\n          <el-input v-model=\"video.videoSize\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"知识点ID\" prop=\"conceptId\">\r\n          <el-input v-model=\"video.conceptId\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"dialogUpdate = false\">取 消</el-button>\r\n              <el-button type=\"primary\" @click=\"updateVideo()\">确 定</el-button>\r\n            </span>\r\n    </el-dialog>\r\n\r\n    <el-dialog\r\n        title=\"提示\"\r\n        :visible.sync=\"dialogInsert\"\r\n        width=\"30%\"\r\n        :before-close=\"handleClose\">\r\n      <el-form ref=\"form\" :model=\"video\">\r\n        <el-form-item label=\"视频名称\" label-width=\"100px\" prop=\"videoName\">\r\n          <el-input v-model=\"video.videoName\" style=\"width: 270px\"></el-input>\r\n        </el-form-item>\r\n<!--        <el-form-item label=\"视频时长\" prop=\"videoDuration\">-->\r\n<!--          <el-input v-model=\"video.videoDuration\"></el-input>-->\r\n<!--        </el-form-item>-->\r\n<!--        <el-form-item label=\"视频大小\" prop=\"videoSize\">-->\r\n<!--          <el-input v-model=\"video.videoSize\"></el-input>-->\r\n<!--        </el-form-item>-->\r\n        <el-form-item label=\"所在知识点\" label-width=\"115px\" prop=\"conceptId\">\r\n          <el-input v-model=\"video.conceptId\" style=\"width: 255px\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n<!--      <el-upload accept=\".mp4\"></el-upload>-->\r\n      <input type=\"file\" ref=\"fileInput\" style=\"display: none\" @change=\"handleFileChange\">\r\n      <el-button @click=\"openFileBrowser\" style=\"width: 200px;height: 100px;font-size: 20px; margin-left: 120px;\">选择视频文件</el-button>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"dialogInsert = false\">取 消</el-button>\r\n              <el-button type=\"primary\" @click=\"uploadVideo()\">确 定</el-button>\r\n            </span>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Upload\",\r\n  data() {\r\n    return {\r\n      videoName:'',\r\n      videoUrl:'',\r\n      videoDuration:0,\r\n      videoSize:0.0,\r\n      conceptId:0,\r\n      tableData: [],\r\n      currentNum: 1,\r\n      pageSize: 10,\r\n      total: 0,\r\n      dataShow:true,\r\n      tableDataShow: true,\r\n      // 修改删除\r\n      dialogUpdate:false,\r\n      video:{},\r\n      form:{\r\n        videoName:'',\r\n        videoUrl:'',\r\n        videoDuration:0,\r\n        videoSize:0.0,\r\n        conceptId:0,\r\n      },\r\n      // 新增\r\n      dialogInsert:false,\r\n      file:null,\r\n      videoData:null,\r\n      formData:null,\r\n    }\r\n  },\r\n  methods:{\r\n    queryPage(){\r\n      let params={\r\n        currentNum: this.currentNum,\r\n        pageSize: this.pageSize,\r\n      };\r\n      this.axios\r\n          .post('/zj/title/queryVideoList.htm',params)\r\n          .then(\r\n              function (response){\r\n                this.tableData=response.data.result.list;\r\n                console.log(this.tableData);\r\n                this.total = response.data.result.count;\r\n                this.tableDataShow=true;\r\n                this.dataShow=true;\r\n              }.bind(this)\r\n          )\r\n          .catch(function (error){\r\n            console.log(error);\r\n          });\r\n    },\r\n    updateVideo(){\r\n\r\n    },\r\n    deleteVideo(){\r\n\r\n    },\r\n    handleClose(done) {\r\n      this.$confirm('确认关闭？')\r\n          .then(_ => {\r\n            done();\r\n          })\r\n          .catch(_ => {\r\n          });\r\n    },\r\n    changePage(page) {\r\n      //设置页码\r\n      this.currentNum = page;\r\n      this.queryPage();\r\n    },\r\n    changePageSize(pageSize) {\r\n      //设置每页展示数量\r\n      this.pageSize = pageSize;\r\n      this.queryPage();\r\n    },\r\n    // 修改删除\r\n    updateClick(row){\r\n      this.dialogUpdate=true;\r\n    },\r\n    deleteCick(row){\r\n      let params={\r\n        videoId:row\r\n      };\r\n      this.axios\r\n          .post('/zj/title/deleteVideo.htm')\r\n          .then(\r\n              function (response) {\r\n                if (response.data.code == \"0000\") {\r\n                  this.$message.success(\"删除成功\");\r\n                  this.dialogVisible = false;\r\n                  this.reload();\r\n                } else {\r\n                  this.$message.error(\"删除失败\");\r\n                }\r\n              }.bind(this)\r\n          ).catch(function (erorr){\r\n            console.log(erorr);\r\n      });\r\n    },\r\n    // 上传视频\r\n    openFileBrowser() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    handleFileChange(event) {\r\n      const file = event.target.files[0];\r\n      // 处理选择的文件，例如上传到服务器等操作\r\n      let formData = new FormData();\r\n      formData.append(\"file\",file);\r\n      this.formData=formData;\r\n    },\r\n    uploadVideo(){\r\n      let params={\r\n        videoName:this.form.videoName,\r\n        videoUrl:this.form.videoUrl,\r\n        videoDuration:this.form.videoDuration,\r\n        videoSize:this.form.videoSize,\r\n        conceptId:this.form.conceptId,\r\n        videoData:this.formData,\r\n      };\r\n      // 将 params 和 formData 合并到一个 FormData 对象中\r\n      let formData = new FormData();\r\n      formData.append(\"file\", this.formData.get(\"file\")); // 从原来的 formData 中获取文件数据\r\n      Object.entries(params).forEach(([key, value]) => {\r\n        formData.append(key, value);\r\n      });\r\n      console.log(formData);\r\n      this.axios\r\n          .post('zj/title/uploadVideo.htm',formData, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data' // 设置请求头为 multipart/form-data\r\n            }}\r\n          )\r\n          .then(\r\n              function (response) {\r\n                if (response.data.code == \"0000\"){\r\n                  this.$message.success(\"上传成功\");\r\n                  this.dialogVisible  = false;\r\n                  this.reload();\r\n                }else {\r\n                  this.$message.error(\"该视频与库中已有视频重复，上传失败，请重新选择\");\r\n                }\r\n              }.bind(this)\r\n          )\r\n          .catch(function (error){\r\n            console.log(error);\r\n          })\r\n    },\r\n  },\r\n  created(){\r\n    this.queryPage();\r\n    console.log('created method called');\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}