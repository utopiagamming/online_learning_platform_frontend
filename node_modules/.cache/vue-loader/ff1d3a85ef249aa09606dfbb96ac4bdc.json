{"remainingRequest":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\working\\projectCodes\\automatic-test-paper\\src\\components\\page\\examination\\Home.vue?vue&type=style&index=0&id=429fa97d&scoped=true&lang=scss&","dependencies":[{"path":"D:\\working\\projectCodes\\automatic-test-paper\\src\\components\\page\\examination\\Home.vue","mtime":1633955552000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\projectCodes\\automatic-test-paper\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n.home {\n  min-width: 600px;\n  overflow-x: auto;\n}\n\n.card-box {\n  margin: 10px;\n\n  .type-title {\n    font-size: 16px;\n    font-weight: bold;\n    margin-bottom: 10px;\n\n    .item-title {\n      display: flex;\n    }\n  }\n\n  .title {\n    margin: 10px 0;\n  }\n\n  .item-box {\n    /*  display: flex;*/\n    /*width: 100%;*/\n    /*align-items: center;*/\n    /* height: 40px;*/\n    /* .label {*/\n    /*  width: 20px;*/\n    /* }*/\n    /*  .value {*/\n    /*  flex: 1;*/\n    /*  }*/\n  }\n\n  .content-box1 {\n    margin-bottom: 30px;\n  }\n}\n",{"version":3,"sources":["Home.vue"],"names":[],"mappings":";AA2aA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/components/page/examination","sourcesContent":["<template>\n  <div>\n    <el-row :gutter=\"20\">\n      <el-col :span=\"2\" style=\"margin-left: 60%\">\n        <el-button @click=\"collBackPaperPage\">返回试卷</el-button>\n      </el-col>\n      <el-col :span=\"3\">\n        <el-button size=\"mini\" @click=\"handleEdit\">自动组卷</el-button>\n      </el-col>\n      <el-col :span=\"2\">\n        <el-button size=\"mini\" @click=\"updateTitle(dataList)\" v-show=\"examShow\">提交修改</el-button>\n      </el-col>\n      <el-col :span=\"2\">\n<!--        <el-button size=\"mini\" v-print=\"'#printMe'\" v-show=\"examShow\">打印试卷</el-button>-->\n         <el-button type=\"primary\" @click=\"PrintRow\"  v-show=\"examShow\">打 印</el-button>\n      </el-col>\n    </el-row>\n\n    <div v-show=\"dataShow\">\n      <el-table :data=\"tableData\" border stripe style=\"width: 100%\">\n        <el-table-column type=\"index\" width=\"50\"></el-table-column>\n        <el-table-column prop=\"paperName\" label=\"试卷名称\"></el-table-column>\n        <el-table-column prop=\"subjectName\" label=\"考试科目\" width=\"100\"></el-table-column>\n        <el-table-column prop=\"className\" label=\"班级\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"paperDate\" label=\"考试日期\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"examDate\" label=\"考试时间\" width=\"135\"></el-table-column>\n        <el-table-column prop=\"paperScore\" label=\"题目总分\" width=\"100\"></el-table-column>\n        <el-table-column prop=\"teachName\" label=\"组卷教师\" width=\"100\"></el-table-column>\n        <el-table-column prop=\"createTime\" label=\"日期\" width=\"150\"></el-table-column>\n        <el-table-column label=\"操作\" width=\"300\">\n          <template slot-scope=\"scope\">\n            <el-button size=\"mini\" @click=\"queryPaper(scope.row)\">查看试卷</el-button>\n            <el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.row)\">删除</el-button>\n            <el-button size=\"mini\" @click=\"exportPaper(scope.row.paperId)\">试卷导出</el-button>\n\n<!--            <div id=\"printMe\" style=\"background:red;\">-->\n<!--              <p>葫芦娃，葫芦娃</p>-->\n<!--              <p>一根藤上七朵花 </p>-->\n<!--              <p>小小树藤是我家 啦啦啦啦 </p>-->\n<!--              <p>叮当当咚咚当当　浇不大</p>-->\n<!--              <p> 叮当当咚咚当当 是我家</p>-->\n<!--              <p> 啦啦啦啦</p>-->\n<!--              <p>...</p>-->\n<!--            </div>-->\n\n<!--            <button v-print=\"'#printMe'\">Print local range</button>-->\n\n          </template>\n        </el-table-column>\n      </el-table>\n      <Page\n          :total=\"total\"\n          show-total\n          show-sizer\n          :page-size-opts=\"[10, 20, 30, 40, 10000]\"\n          v-show=\"tableDataShow\"\n          @on-change=\"changePage\"\n          @on-page-size-change=\"changePageSize\"\n          style=\"text-align: center\"\n      />\n    </div>\n\n    <div class=\"formClass\" v-show=\"formShow\" >\n      <el-form ref=\"form\" :model=\"form\" label-width=\"100px\">\n        <el-form-item label=\"试卷名称：\">\n          <el-input type=\"textarea\" v-model=\"form.titleName\" style=\"width: 20%\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"试卷科目：\">\n          <el-select v-model=\"form.subjectId\" clearable placeholder=\"请选择科目\">\n            <el-option v-for=\"(item, index) in this.subjectList\" :label=\"item.subjectName\"\n                       :value=\"item.subjectId\" :key=\"index\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"考试班级：\">\n          <el-select v-model=\"form.classId\" clearable placeholder=\"请选择班级\">\n            <el-option v-for=\"(item, index) in this.classList\" :label=\"item.className\" :value=\"item.classId\"\n                       :key=\"index\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"难度系数：\">\n          <el-col :span=\"2\">\n            <el-input v-model=\"form.titleType\"></el-input>\n          </el-col>\n        </el-form-item>\n        <el-form-item label=\"考试日期\">\n          <el-col :span=\"3.5\">\n            <el-date-picker type=\"date\" placeholder=\"选择日期\" value-format=\"yyyy-MM-dd\"\n                            v-model=\"form.date1\"></el-date-picker>\n          </el-col>\n        </el-form-item>\n        <el-form-item label=\"考试时间\">\n          <el-input v-model=\"form.examDate\" style=\"width: 10%\" value-format=\"HH-mm-ss\"></el-input>\n          分钟\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"onSubmit\">开始组卷</el-button>\n          <el-button @click=\"paperCancel\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n\n    <div id=\"printMe\" ref=\"print\" class=\"home\" >\n      <el-card class=\"card-box\" v-for=\"item of dataList\" :key=\"item.id\" v-show=\"examShow\">\n        <!-- 单选 1    填空2    主观3 -->\n        <div>\n          <div class=\"item-title\"  v-for=\"(item2, index2) of item.list\" :key=\"index2\">\n\n            <div class=\"title\">\n              {{ index2 + 1 }}.{{ item2.titleName }}。{{ item2.titleFraction }}分</div>\n            <div class=\"content-box1\" v-if=\"item.type === 3\">\n              <el-input type=\"textarea\" :rows=\"6\" placeholder=\"请输入内容\" v-model=\"item2.answer\"></el-input>\n            </div>\n            <div class=\"item-box\" v-if=\"item2.type === 1\">\n              <el-radio-group v-model=\"item2.answer\">\n                <el-radio :label=\"item2.choice1\"></el-radio>\n                <el-radio :label=\"item2.choice2\"></el-radio>\n                <el-radio :label=\"item2.choice3\"></el-radio>\n                <el-radio :label=\"item2.choice4\"></el-radio>\n              </el-radio-group>\n            </div>\n            <div class=\"item-box\" v-if=\"item2.type === 2\">\n              <el-checkbox-group v-model=\"item2.answer\">\n                <el-input type=\"textarea\" :rows=\"6\" placeholder=\"请输入内容\" v-model=\"item2.answer\"></el-input>\n              </el-checkbox-group>\n            </div>\n          </div>\n        </div>\n      </el-card>\n\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Loading } from 'element-ui';\nimport printPaper from \"./printPaper\";\nimport vueEasyPrint from \"vue-easy-print\";\n\nexport default {\n  inject: ['reload'],\n  data() {\n    return {\n      tabledata:[],\n\n      tableData: [],\n      currentNum: 1,\n      pageSize: 10,\n      total: 0,\n      tableDataShow: false,\n      subjectList: [],\n      classList: [],\n      dataShow: true,\n      formShow: false,\n      examShow: false,\n      form: {\n        date2: '',\n        date1: '',\n        num: 15,\n        classId: '',\n        subjectId: '',\n        titleType: '',\n        titleName: '',\n        examDate: '',\n        paperNum: ''\n      },\n      dataList: [],\n    };\n  },\n  components: { vueEasyPrint,printPaper },\n\n  methods: {\n    PrintRow(index, row){\n      this.$print(this.$refs.print) // 使用\n    },\n\n    updateTitle(dataList){\n      let jsonArr = [];\n      let newArr = dataList.filter((item, i) => {\n        console.log(\"循环==i==\", item);\n        let listArr = item.list.filter((list,i)=>{\n          let obj = {};\n          obj.id = list.id;\n          obj.answer = list.answer;\n          jsonArr.push(JSON.stringify(obj))\n        })\n      })\n      let params = {\n        titleString:jsonArr,\n      };\n      this.axios\n          .post('/zj/title/updateTitleByList.htm', params)\n          .then(\n              function (response) {\n                if (response.data.code == '0000') {\n                  this.$message.success('提交成功');\n                  this.reload();\n                } else {\n                  this.$message.error('提交失败');\n                }\n              }.bind(this))\n          .catch(function (error) {\n            console.log(error);\n          });\n    },\n    checkForm() {\n      let all = [];\n      this.dataList.map((x) => {``\n        x.list &&\n        x.list.map((y) => {\n          all.push({ id: y.id, val: y.val });\n        });\n      });\n      this.$emit('updateTitle', all);\n    },\n    endLoading() {    //使用Element loading-close 方法\n      let loadingInstance = Loading.service();\n      this.$nextTick(() => { // 以服务的方式调用的 Loading 需要异步关闭\n        loadingInstance.close();\n      });\n    },\n    onSubmit() {\n      let params = {\n        paperName: this.form.titleName,\n        subjectId: this.form.subjectId,\n        difficulty: this.form.titleType,\n        classId: this.form.classId,\n        titleStatus: this.form.titleStatus,\n        titleAnswer: this.form.titleAnswer,\n        paperDate: this.form.date1,\n        examDate: this.form.examDate,\n        paperNum: this.form.paperNum\n      };\n      Loading.service();\n      this.axios\n          .post('/zj/title/audioExam.htm', params)\n          .then(\n              function (response) {\n                if (response.data.code == '0000') {\n                  this.$message.success('组卷成功,请点击返回试卷然后查看');\n                  this.formShow = false;\n                  this.examShow = true;\n                  this.endLoading();\n                } else {\n                  this.$message.error(response.data.description);\n                  this.endLoading();\n                }\n              }.bind(this)\n          )\n          .catch(function (error) {\n            this.endLoading();\n            console.log(error);\n          });\n    },\n    collBackPaperPage() {\n      this.dataShow = true;\n      this.formShow = false;\n      this.examShow = false;\n      this.queryPaperPage();\n      this.reload();\n    },\n    changePage(page) {\n      //设置页码\n      this.currentNum = page;\n      this.queryPaperPage();\n    },\n    changePageSize(pageSize) {\n      //设置每页展示数量\n      this.pageSize = pageSize;\n      this.queryPaperPage();\n    },\n    handleChange(value) {\n      console.log(value);\n    },\n    paperCancel(row) {\n      this.dataShow = true;\n      this.formShow = false;\n      this.examShow = false;\n    },\n    handleEdit() {\n      this.dataShow = false;\n      this.formShow = true;\n      this.examShow = false;\n    },\n    exportPaper(paperId){\n      let param = {\n        paperId:paperId\n      };\n      const form = document.createElement('form');\n      form.id = 'form';\n      form.name = 'form';\n      document.body.appendChild(form);\n      for (const obj in param) {\n        if (param.hasOwnProperty(obj)) {\n          const input = document.createElement('input');\n          input.tpye = 'hidden';\n          input.name = obj;\n          input.value = param[obj];\n          form.appendChild(input);\n        }\n      }\n      form.method = 'GET'; //请求方式\n      form.action = '/zj/paper/paperExport.htm';\n      form.submit();\n      document.body.removeChild(form);\n    },\n\n    handleDelete(row) {\n      let params = {\n        paperId: row.paperId\n      };\n      this.axios\n          .post('/zj/paper/deletePaper.htm', params)\n          .then(\n              function (response) {\n                if (response.data.code == \"0000\") {\n                  this.$message.success(\"删除成功\");\n                  this.reload();\n                } else {\n                  this.$message.error(\"删除失败\");\n                }\n              }.bind(this)\n          )\n          .catch(function (error) {\n            console.log(error);\n          });\n    },\n    queryPaperPage() {\n      let params = {\n        currentNum: this.currentNum,\n        pageSize: this.pageSize\n      };\n      this.axios\n          .post('/zj/title/queryPaperPage.htm', params)\n          .then(\n              function (response) {\n                this.tableData = response.data.result.list;\n                // this.total = response.data.result.count;\n                this.tableDataShow = true;\n              }.bind(this)\n          )\n          .catch(function (error) {\n            console.log(error);\n          });\n    },\n\n    queryPaper(row) {\n      let params = {\n        paperId: row.paperId\n      };\n      this.axios\n          .post('/zj/title/queryPaper.htm', params)\n          .then(\n              function (response) {\n                if (response.data.code == '0000') {\n                  this.formShow = false;\n                  this.dataShow = false;\n                  this.examShow = true;\n                  this.dataList.push({\n                    list: this.changeArray(response.data.result.oneList1, 1, 'type'),\n\n                  });\n                  this.dataList.push({\n                    list: this.changeArray(response.data.result.oneList2, 2, 'type'),\n                  });\n                  this.dataList.push({\n                    list: this.changeArray(response.data.result.oneList3, 2, 'type'),\n                  });\n                  console.log(this.dataList);\n\n\n                } else {\n                  this.$message({message: '该试卷错误', type: 'error'});\n                }\n              }.bind(this)\n          )\n          .catch(function (error) {\n            console.log(error);\n          });\n    },\n    changeArray(one, val, name) {\n      one.map((x) => {\n        x[name] = val;\n        x['val'] = '';\n      });\n      return one;\n    },\n    querySubjectList() {\n      this.axios\n          .post('/zj/sub/queryListBySub.htm')\n          .then(\n              function (response) {\n                this.subjectList = response.data.result;\n              }.bind(this)\n          )\n          .catch(function (error) {\n            console.log(error);\n          });\n    },\n    queryClassList() {\n      this.axios\n          .post('/zj/class/queryList.htm')\n          .then(\n              function (response) {\n                this.classList = response.data.result;\n              }.bind(this)\n          )\n          .catch(function (error) {\n            console.log(error);\n          });\n    },\n\n  },\n  created() {\n    this.querySubjectList();\n    this.queryClassList();\n    this.queryPaperPage();\n  }\n};\n\n\n\n\n</script>\n<style scoped lang='scss'>\n.home {\n  min-width: 600px;\n  overflow-x: auto;\n}\n\n.card-box {\n  margin: 10px;\n\n  .type-title {\n    font-size: 16px;\n    font-weight: bold;\n    margin-bottom: 10px;\n\n    .item-title {\n      display: flex;\n    }\n  }\n\n  .title {\n    margin: 10px 0;\n  }\n\n  .item-box {\n    /*  display: flex;*/\n    /*width: 100%;*/\n    /*align-items: center;*/\n    /* height: 40px;*/\n    /* .label {*/\n    /*  width: 20px;*/\n    /* }*/\n    /*  .value {*/\n    /*  flex: 1;*/\n    /*  }*/\n  }\n\n  .content-box1 {\n    margin-bottom: 30px;\n  }\n}\n</style>\n"]}]}