"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModalController=ModalController,exports.default=exports.Modal=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_modal=_interopRequireDefault(require("./src/modal")),_activities=_interopRequireDefault(require("./src/activities")),_vXETable=_interopRequireDefault(require("../v-x-e-table")),_tools=require("../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var ModalClass=null;function openModal(e){var r=Object.assign({},e,{transfer:!0});return new Promise(function(o){if(r&&r.id&&_activities.default.some(function(e){return e.id===r.id}))o("exist");else{var t=r.events||{};r.events=Object.assign({},t,{hide:function(e){t.hide&&t.hide.call(this,e),setTimeout(function(){return l.$destroy()},l.isMsg?500:100),o(e.type)}});var l=new ModalClass({el:document.createElement("div"),propsData:r});setTimeout(function(){l.isDestroy?l.close():l.open()})}})}function ModalController(e){return _tools.UtilTools.warn("vxe.error.delFunc",["Modal","Modal.open"]),openModal(e)}function closeModal(e){return(arguments.length?[getModal(e)]:_activities.default).forEach(function(e){e&&(e.isDestroy=!0,e.close("close"))}),Promise.resolve()}function getModal(o){return _ctor.default.find(_activities.default,function(e){return e.id===o})}["alert","confirm","message"].forEach(function(r,a){var n=2===a?{mask:!1,lockView:!1,showHeader:!1}:{showFooter:!0};n.type=r,n.dblclickZoom=!1,1===a&&(n.status="question"),ModalController[r]=function(e,o,t){var l={};return _ctor.default.isObject(e)?l=e:(o&&(l=2===a?{status:o}:{title:o}),l.content=_ctor.default.toString(e)),openModal(Object.assign({type:r},n,l,t))}}),ModalController.closeAll=function(){_tools.UtilTools.warn("vxe.error.delFunc",["closeAll","close"]),closeModal()},ModalController.get=getModal,ModalController.close=closeModal,ModalController.open=openModal,ModalController.install=function(e){_vXETable.default._modal=1,e.component("vxe-message",_modal.default),e.component(_modal.default.name,_modal.default),ModalClass=e.extend(_modal.default),e.prototype.$XMsg=ModalController,e.prototype.$XModal=ModalController,_vXETable.default.$modal=ModalController,_vXETable.default.modal=ModalController,e.prototype.$vxe?e.prototype.$vxe.modal=ModalController:e.prototype.$vxe={modal:ModalController}};var Modal=ModalController;exports.Modal=Modal;var _default=ModalController;exports.default=_default;