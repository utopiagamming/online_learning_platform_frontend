"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_vXETable=_interopRequireDefault(require("../../v-x-e-table")),_tools=require("../../tools"),_conf=_interopRequireDefault(require("../../conf"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function renderPrefixIcon(e,t){return e("span",{class:"vxe-form--item-title-prefix"},[e("i",{class:t.icon||_conf.default.icon.FORM_PREFIX})])}function renderSuffixIcon(e,t){return e("span",{class:"vxe-form--item-title-suffix"},[e("i",{class:t.icon||_conf.default.icon.FORM_SUFFIX})])}function renderTitle(e,t){var i=t.title,l=t.titlePrefix,r=t.titleSuffix,n=[];return l&&n.push(l.content||l.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(l.content||l.message),enterable:l.enterable,theme:l.theme}},[renderPrefixIcon(e,l)]):renderPrefixIcon(e,l)),n.push(e("span",{class:"vxe-form--item-title-label"},_tools.UtilTools.getFuncText(i))),r&&n.push(r.content||r.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(r.content||r.message),enterable:r.enterable,theme:r.theme}},[renderSuffixIcon(e,r)]):renderSuffixIcon(e,r)),n}var _default={name:"VxeFormItem",props:{title:String,field:String,size:String,span:[String,Number],align:String,titleAlign:String,titleWidth:[String,Number],className:[String,Function],titleOverflow:{type:[Boolean,String],default:null},titlePrefix:Object,titleSuffix:Object,resetValue:{default:null},visible:{type:Boolean,default:null},visibleMethod:Function,folding:Boolean,collapseNode:Boolean,itemRender:Object},inject:{$vxeform:{default:null}},data:function(){return{showError:!1,showRule:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isRequired:function(){var e=this.$vxeform,t=this.field;if(e&&e.rules){var i=e.rules[t];if(i)return i.some(function(e){return e.required})}return!1},errRule:function(){var e=this.$vxeform,i=this.field;return e?_ctor.default.find(e.invalids,function(e){var t=e.property;return i===t}):null}},watch:{errRule:function(e){var t=this;clearTimeout(this.showErrTimeout),this.showError=!1,e?(this.showRule=e.rule,setTimeout(function(){t.showError=!0},30)):this.showErrTimeout=setTimeout(function(){t.showRule=null},350)}},render:function(e){var t=this._e,i=this.$scopedSlots,l=this.$vxeform,r=this.title,n=this.folding,o=this.visible,s=this.visibleMethod,a=this.field,u=this.className,c=this.collapseNode,f=this.itemRender,d=this.isRequired,m=this.showError,h=this.showRule,v=this.titleOverflow,p=f?_vXETable.default.renderer.get(f.name):null,g=this.span||l.span,x=this.align||l.align,_=this.titleAlign||l.titleAlign,b=this.titleWidth||l.titleWidth,R=l.collapseAll,T=s,w=_ctor.default.isUndefined(v)||_ctor.default.isNull(v)?l.titleOverflow:v,S="title"===w,F=!0===w||"tooltip"===w,I=S||F||"ellipsis"===w,O={data:l.data,property:a,item:this,$form:l};if(!1===o)return t();!T&&p&&p.itemVisibleMethod&&(T=p.itemVisibleMethod);var E=[];p&&p.renderItemContent?E=p.renderItemContent.call(this,e,f,O):p&&p.renderItem?(_tools.UtilTools.warn("vxe.error.delFunc",["renderItem","renderItemContent"]),E=p.renderItem.call(this,e,f,O)):i&&i.default?E=i.default.call(this,O,e):a&&(E=["".concat(_ctor.default.get(l.data,a))]);var q=F&&l?{mouseenter:function(e){l.triggerHeaderHelpEvent(e,O)},mouseleave:l.handleTargetLeaveEvent}:{};return e("div",{class:["vxe-form--item",g?"vxe-col--".concat(g," is--span"):null,u,{"is--title":r,"is--required":d,"is--hidden":n&&R,"is--active":!T||T(O),"is--error":m}]},[e("div",{class:"vxe-form--item-inner"},[r?e("div",{class:["vxe-form--item-title",_?"align--".concat(_):null,{"is--ellipsis":I}],style:b?{width:isNaN(b)?b:"".concat(b,"px")}:null,attrs:{title:S?_tools.UtilTools.getFuncText(r):null},on:q},renderTitle(e,this)):null,e("div",{class:["vxe-form--item-content",x?"align--".concat(x):null]},E.concat([c?e("div",{class:"vxe-form--item-trigger-node",on:{click:this.toggleCollapseEvent}},[e("span",{class:"vxe-form--item-trigger-text"},R?_conf.default.i18n("vxe.form.unfolding"):_conf.default.i18n("vxe.form.folding")),e("i",{class:["vxe-form--item-trigger-icon",R?_conf.default.icon.FORM_FOLDING:_conf.default.icon.FORM_UNFOLDING]})]):null,h&&l.validOpts.showMessage?e("div",{class:"vxe-form--item-valid",style:h.maxWidth?{width:"".concat(h.maxWidth,"px")}:null},h.message):null]))])])},methods:{toggleCollapseEvent:function(e){var t=this.$vxeform;t.toggleCollapse(),t.$emit("toggle-collapse",{collapse:!t.collapseAll,data:t.data,$form:t,$event:e},e)}}};exports.default=_default;